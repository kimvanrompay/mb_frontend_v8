<div class="register-container">
    <!-- Glassmorphic Animated Shapes -->
    <div class="glass-shape glass-shape-1"></div>
    <div class="glass-shape glass-shape-2"></div>
    <div class="glass-shape glass-shape-3"></div>
    <div class="glass-shape glass-shape-4"></div>

    <div class="register-content">

        <!-- Header section (right side) -->
        <div class="header">
            <img src="https://res.cloudinary.com/dg0qxqj4a/image/upload/v1768848576/Boat_Logo_Black_na90ec.png"
                alt="Meribas" class="logo" />

            <h1 class="title">
                Start your <strong>free trial</strong>
            </h1>

            <p class="subtitle">
                No credit card required
            </p>
        </div>

        <!-- Form section (left side) -->
        <div class="form-section">

            <!-- Error Message -->
            <div *ngIf="errorMessage" class="error-container">
                <p class="error-title">{{ errorMessage }}</p>
                <ul *ngIf="errors.length > 0" class="error-list">
                    <li *ngFor="let error of errors">{{ error }}</li>
                </ul>
            </div>

            <!-- Stepper Form -->
            <div class="form-container">
                    <mat-stepper linear #stepper>
                        <!-- Step 1: Company Information -->
                        <mat-step [stepControl]="companyForm">
                            <form [formGroup]="companyForm">
                                <ng-template matStepLabel>Company</ng-template>

                                <div class="step-content">
                                    <!-- Company Name -->
                                    <mat-form-field appearance="fill" class="full-width">
                                        <mat-label>Company name</mat-label>
                                        <input matInput formControlName="tenant_name" placeholder="Acme Corporation" />
                                        <mat-error *ngIf="tenant_name?.errors?.['required']">
                                            Required
                                        </mat-error>
                                    </mat-form-field>

                                    <!-- Subdomain -->
                                    <mat-form-field appearance="fill" class="full-width">
                                        <mat-label>Workspace URL</mat-label>
                                        <input matInput formControlName="tenant_subdomain" placeholder="acme" />
                                        <span matTextSuffix>.meribas.app</span>
                                        <mat-error *ngIf="tenant_subdomain?.errors?.['required']">
                                            Required
                                        </mat-error>
                                        <mat-error *ngIf="tenant_subdomain?.errors?.['pattern']">
                                            Letters, numbers, hyphens only
                                        </mat-error>
                                        <mat-error *ngIf="tenant_subdomain?.errors?.['minlength'] || tenant_subdomain?.errors?.['maxlength']">
                                            3-30 characters required
                                        </mat-error>
                                    </mat-form-field>

                                    <!-- Next Button -->
                                    <div class="button-group">
                                        <button mat-flat-button color="primary" matStepperNext class="next-button">
                                            Continue
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </mat-step>

                        <!-- Step 2: Personal Information -->
                        <mat-step [stepControl]="personalForm">
                            <form [formGroup]="personalForm">
                                <ng-template matStepLabel>Personal</ng-template>
                                <div class="step-content">
                                    <!-- Name Fields -->
                                    <div class="name-fields">
                                        <mat-form-field appearance="fill" class="half-width">
                                            <mat-label>First name</mat-label>
                                            <input matInput formControlName="first_name" placeholder="John" />
                                            <mat-error *ngIf="first_name?.errors?.['required']">
                                                Required
                                            </mat-error>
                                        </mat-form-field>

                                        <mat-form-field appearance="fill" class="half-width">
                                            <mat-label>Last name</mat-label>
                                            <input matInput formControlName="last_name" placeholder="Doe" />
                                            <mat-error *ngIf="last_name?.errors?.['required']">
                                                Required
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <!-- Email -->
                                    <mat-form-field appearance="fill" class="full-width">
                                        <mat-label>Email</mat-label>
                                        <input matInput type="email" formControlName="email" placeholder="you@example.com" />
                                        <mat-error *ngIf="email?.errors?.['required']">
                                            Required
                                        </mat-error>
                                        <mat-error *ngIf="email?.errors?.['email']">
                                            Invalid email
                                        </mat-error>
                                    </mat-form-field>

                                    <!-- Password -->
                                    <mat-form-field appearance="fill" class="full-width">
                                        <mat-label>Password</mat-label>
                                        <input matInput type="password" formControlName="password" placeholder="At least 6 characters" />
                                        <mat-error *ngIf="password?.errors?.['minlength']">
                                            Min 6 characters
                                        </mat-error>
                                    </mat-form-field>

                                    <!-- Confirm Password -->
                                    <mat-form-field appearance="fill" class="full-width">
                                        <mat-label>Confirm password</mat-label>
                                        <input matInput type="password" formControlName="password_confirmation" placeholder="Type it again" />
                                        <mat-error *ngIf="personalForm.errors?.['passwordMismatch']">
                                            Passwords do not match
                                        </mat-error>
                                    </mat-form-field>

                                    <!-- Terms -->
                                    <mat-checkbox formControlName="termsAgreed" class="terms-checkbox">
                                        I agree to the
                                        <a href="#" class="link">Terms</a>
                                        and
                                        <a href="#" class="link">Privacy Policy</a>
                                    </mat-checkbox>

                                    <!-- Buttons -->
                                    <div class="button-group">
                                        <button mat-button matStepperPrevious class="back-button">
                                            Back
                                        </button>
                                        <button mat-flat-button
                                                color="primary"
                                                (click)="onSubmit()"
                                                [disabled]="isLoading || companyForm.invalid || personalForm.invalid"
                                                class="submit-button">
                                            <span *ngIf="!isLoading">Create account</span>
                                            <span *ngIf="isLoading" class="loading-content">
                                                <mat-spinner diameter="20"></mat-spinner>
                                                <span>Creating...</span>
                                            </span>
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </mat-step>
                    </mat-stepper>
            </div>

            <!-- Sign In Link -->
            <div class="signin-section">
                <p class="signin-text">
                    Already have an account?
                    <a routerLink="/login" class="link">Sign in</a>
                </p>
            </div>
        </div>
    </div>
</div>
